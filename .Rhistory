dir()
setwd('F:\\DataW\\shiwan-data')
dir()
SpeDat <- readLines('ShiWanDaShan-AllSpecies.txt')
head(SpeDat)
summary(SpeDat)
setwd('F:\\DataW\\shiwan-data')
dir()
spedat <- readLines('ShiWanDaShan-AllSpecies.txt')
head(spedat)
summary(spedat)
spedat
spedat <- readLines('ShiWanDaShan-AllSpecies.txt')
grep(剑叶鸢尾兰,spedat)
grep('剑叶鸢尾兰',spedat)
spedat[g00]
g00 <- grep('剑叶鸢尾兰',spedat)
spedat[g00]
fam00 <- grep('科',spedat)
fam00
spedat[fam00]
fam00 <- grep('科 ',spedat)
spedat[fam00]
fam00 <- grep('\\. \\w+科 ',spedat)
spedat[fam00]
gen00 <- grep('属 ',spedat)
spedat[gen00]
gen00 <- grep('属 [A-Z]',spedat)
spedat[gen00]
fam00 <- grep('\\. \\w+科 ',spedat)
spedat[fam00]
fam00 <- grep('\\. \\w+科 +[A-Z]',spedat)
spedat[fam00]
fam00 <- grep('科 +[A-Z]',spedat)
gen00 <- grep('属 +[A-Z]',spedat)
spedat[fam00]
spedat[gen00]
fam00 <- grep('科 [A-Z]',spedat)
spedat[fam00]
fam00 <- grep('科 +[A-Z]',spedat)
spedat[fam00]
spedat[gen00]
fam00
gen00
dir()
dir()
dat00 <- read.csv('SpeDat00.csv')
dat00
dat01 <- gsub(' ','',dat00)
dat01
dat01 <- gsub(' ','',dat00[,1])
dat01
dat00[,1]
dat01 <- gsub(' ','',dat00[,'种名'])
dat01
spe00 <- grep(dat01,spedat)
spedat
lapply(dat01,function(xx){grep(xx,spedat)})
spedat
xx <-'竹'
grep(xx,spedat)
grep('竹 ',spedat)
grep('^竹 ',spedat)
xx <-'雀稗'
grep('^雀稗 ',spedat)
spedat[g00]
g00 <- grep('^雀稗 ',spedat)
spedat[g00]
paste('^',xx,' ',sep='')
g00 <-grep(paste('^',xx,' ',sep=''),spedat)
spedat[g00]
lapply(dat01, function(xx){
grep(paste('^',xx,' ',sep=''), spedat)
})
la00 <- lapply(dat01, function(xx){
grep(paste('^',xx,' ',sep=''), spedat)
})
la00
unlist(la00)
unlist(la00use.names =F)
unlist(la00，use.names =F)
unlist(la00, use.names =F)
unlist(la00, use.names =T)
unlist(la00, recursive = TRUE)
unlist(la00, recursive =F)
la00
la00 <- sapply(dat01, function(xx){
grep(paste('^',xx,' ',sep=''), spedat)
})
la00
unlist(la00, recursive =F)
sapply(la00,length)
which(sapply(la00,length)==1)
wh00 <- which(sapply(la00,length)==1)
wh00
la00
unlist(la00)
spedat[unlist(la00)]
gsub('.+ +.+ +.+ +' ,\\1,spedat[unlist(la00)][1])
gsub('.+ +(.+ +.+) +' ,\\1,spedat[unlist(la00)][1])
gsub('.+ +(.+ +.+) +' ,"\\1",spedat[unlist(la00)][1])
spedat[unlist(la00)][1]
gsub('.+ +([A-Z].+ +[a-z].+) +.*' ,"\\1",spedat[unlist(la00)][1])
gsub('.+ +([A-Z].+ +[a-z]+) +.*' ,"\\1",spedat[unlist(la00)][1])
dat01[wh00]
gsub('.+ +([A-Z].+ +[a-z]+) +.*' ,"\\1",spedat[unlist(la00)][1])
spedat[unlist(la00)][1]
gsub('\\W+ +([A-Z][a-z]+ +[a-z]+) +.*' ,"\\1",spedat[unlist(la00)][1])
gsub('\\W+ +([A-Z][a-z]+ +[a-z]+) +.*' ,"\\1",spedat[unlist(la00)][1])
gsub('\\w+ +([A-Z][a-z]+ +[a-z]+) +.*' ,"\\1",spedat[unlist(la00)][1])
gsub('\\w+ +([A-Z][a-z]+ +[a-z]+) +.*' ,"\\1",spedat[unlist(la00)])
dat01[wh00]
dat00
dat00$lading[wh00] <- gsub('\\w+ +([A-Z][a-z]+ +[a-z]+) +.*' ,"\\1",spedat[unlist(la00)])
dat00
wh00
gen00
la00
1213-gen00
gen01 <- 1213-gen00
c(gen00,la00)
sort(gen00,la00)
sort(gen00,unlist(la00))
unlist(la00)
gen00
as.numeric(la00)
sort(gen00, as.numeric(la00))
sort(c(gen00, as.numeric(la00)), na.last=NA)
sort(c(gen00, la01), na.last=NA)
la01 <- as.numeric(la00)
sort(c(gen00, la01), na.last=NA)
match(la01, sort(c(gen00, la01), na.last=NA))
la01
match(la01, sor00)
sor00 <- sort(c(gen00, la01), na.last=NA)
match(la01, sor00)
na.omit(la01)
la01
match(na.omit(la01), sor00)
gen00[no.01]
no.01 <- match(na.omit(la01), sor00)-1
gen00[no.01]
spedat[no.01]
spedat[gen00[no.01]]
spedat[sor00[no.01]]
sor00
grep('属 +[A-Z]',spedat)
spedat[sor00[no.01]]
gen00 <- grep('属 +[A-Z]',spedat)
spedat[gen00]
la01
as.numeric(na.omit(la00))
na.omit(as.numeric(la00))
la01 <- na.omit(as.numeric(la00))
la01
spedat[la01]
sor00 <- sort(c(gen00, la01))
sor00
no.la01 <- match(la01, sor00)-1
match(la01, sor00)
la01
cut(la01, gen00)
table(cut(la01, gen00))
la01
cut(la01, gen00)
cu00 <- cut(la01, gen00)
cu00
mode(cu00)
cu00[1]
gsub('\\(([0-9]+)\\,[0-9]+\\)', '\\1', cu00[1])
gsub('\\(([0-9]+)\\,[0-9]+\\]', '\\1', cu00[1])
gsub('\\(([0-9]+),[0-9]+\\]', '\\1', cu00[1])
gsub('\\(([0-9]+),[0-9]+]', '\\1', cu00[1])
gsub('(([0-9]+),[0-9]+]', '\\1', cu00[1])
gsub('\\(([0-9]+),[0-9]+]', '\\1', cu00[1])
as.numeric(g00)-1
as.numeric(g00)
g00 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu00[1])
as.numeric(g00)
g00
as.numeric(g00)-1
spedat[as.numeric(g00)-1]
spedat[as.numeric(g00)]
gsub('(\\w+) +[A-Z].*','\\1',spedat[as.numeric(g00)])
g00 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu00)
gsub('(\\w+) +[A-Z].*','\\1',spedat[as.numeric(g00)])
cut(la01, fam00)
g01 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu0)
g01 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu01)
cu01 <- cut(la01, fam00)
g01 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu01)
g01
gsub('(\\w+) +[A-Z].*','\\1',spedat[as.numeric(g01)])
spedat[as.numeric(g01)]
gsub('.* (\\w+ +[A-Z][a-z]+) ','\\1',spedat[as.numeric(g01)])
dat00$family[wh00] <- gsub('.* (\\w+ +[A-Z][a-z]+) ','\\1',spedat[as.numeric(g01)])
dat00
wh00 <- which(sapply(la00,length)==1)
dat00$species[wh00] <- gsub('\\w+ +([A-Z][a-z]+ +[a-z]+) +.*' ,"\\1",spedat[unlist(la00)])
la01 <- na.omit(as.numeric(la00))
cu00 <- cut(la01, gen00)
g00 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu00)
dat00$genus[wh00] <- gsub('(\\w+) +[A-Z].*','\\1',spedat[as.numeric(g00)])
cu01 <- cut(la01, fam00)
g01 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu01)
dat00$family[wh00] <- gsub('.* (\\w+ +[A-Z][a-z]+) ','\\1',spedat[as.numeric(g01)])
dat00
setwd('F:\\DataW\\shiwan-data')
dir()
spedat <- readLines('ShiWanDaShan-AllSpecies.txt')
fam00 <- grep('科 +[A-Z]',spedat)
gen00 <- grep('属 +[A-Z]',spedat)
dat00 <- read.csv('SpeDat00.csv')
dat01 <- gsub(' ','',dat00[,'种名'])
la00 <- sapply(dat01,
function(xx){grep(paste('^',xx,' ',sep=''), spedat)}
)
wh00 <- which(sapply(la00,length)==1)
dat00$species[wh00] <- gsub('\\w+ +([A-Z][a-z]+ +[a-z]+) +.*' ,"\\1",spedat[unlist(la00)])
la01 <- na.omit(as.numeric(la00))
cu00 <- cut(la01, gen00)
g00 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu00)
dat00$genus[wh00] <- gsub('(\\w+) +[A-Z].*','\\1',spedat[as.numeric(g00)])
cu01 <- cut(la01, fam00)
g01 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu01)
dat00$family[wh00] <- gsub('.* (\\w+ +[A-Z][a-z]+) ','\\1',spedat[as.numeric(g01)])
dat00
gsub('(\\w+) +[A-Z].+','\\1',fam01)
fam01 <- gsub('.* (\\w+ +[A-Z][a-z]+) ','\\1',spedat[as.numeric(g01)])
gsub('(\\w+) +[A-Z].+','\\1',fam01)
gsub('\\w+ +([A-Z].+)','\\1',fam01)
unlist(la00)
la00
spedat[la00]
spedat[la00]
na.omit(as.numeric(la00))
la00
spedat[la01]
la01
which(sapply(la00,length)==1)
attr(la01,'na.action')
wh00 <- attr(la01,'na.action')
dat00$species[wh00]
la01 <- na.omit(as.numeric(la00))
NA00 <- attr(la01,'na.action')
dat00$species[-NA00] <- gsub('\\w+ +([A-Z][a-z]+ +[a-z]+) +.*' ,
"\\1",spedat[la01])
dat00$species
cu00
gsub('(\\w+) +[A-Z].*','\\1',
spedat[as.numeric(g00)])
dat00$genus <- gsub('(\\w+) +[A-Z].*','\\1',
spedat[as.numeric(g00)])
cut(la00, gen00)
gen00 <- grep('属 +[A-Z]',spedat)
cu00 <- cut(la01, gen00)
cu00
la01 <- as.numeric(la00)
as.numeric(la00)
cut(la01, gen00)
g00 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu00)
g00
cu00 <- cut(la01, gen00)
g00 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu00)
g00
gsub('(\\w+) +[A-Z].*',
'\\1', spedat[as.numeric(g00)])
as.numeric(la00)
dat00$species <- gsub('\\w+ +([A-Z][a-z]+ +[a-z]+) +.*',
"\\1", spedat[la01])
gen00 <- grep('属 +[A-Z]',spedat)
la01 <- as.numeric(la00)
gsub('\\w+ +([A-Z][a-z]+ +[a-z]+) +.*',
"\\1", spedat[la01])
#
setwd('F:\\DataW\\shiwan-data')
spedat <- readLines('ShiWanDaShan-AllSpecies.txt')
dat00 <- read.csv('SpeDat00.csv')
dat01 <- gsub(' ','',dat00[,'种名'])
la00 <- sapply(dat01,
function(xx){grep(paste('^',xx,' ',sep=''), spedat)}
)
la01 <- as.numeric(la00)
dat00$species <- gsub('\\w+ +([A-Z][a-z]+ +[a-z]+) +.*',
"\\1", spedat[la01])
gen00 <- grep('属 +[A-Z]', spedat)
cu00 <- cut(la01, gen00)
gs00 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu00)
dat00$genus <- gsub('(\\w+) +[A-Z].*',
'\\1', spedat[as.numeric(g00)])
fam00 <- grep('科 +[A-Z]',spedat)
cu01 <- cut(la01, fam00)
gs01 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu01)
fam01 <- gsub('.* (\\w+ +[A-Z][a-z]+) ','\\1',
spedat[as.numeric(g01)])
dat00$科名 <- gsub('(\\w+) +[A-Z].+','\\1', fam01)
dat00$family <- gsub('\\w+ +([A-Z].+)','\\1', fam01)
cu01 <- cut(la01, fam00)
cu01
gs01 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu01)
gs01
fam01
as.numeric(g01)
fam00 <- grep('科 +[A-Z]',spedat)
cu01 <- cut(la01, fam00)
gs01 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu01)
fam01 <- gsub('.* (\\w+ +[A-Z][a-z]+) ','\\1',
spedat[as.numeric(gs01)])
dat00$科名 <- gsub('(\\w+) +[A-Z].+','\\1', fam01)
dat00$family <- gsub('\\w+ +([A-Z].+)','\\1', fam01)
####
########################################################
#
setwd('F:\\DataW\\shiwan-data')
spedat <- readLines('ShiWanDaShan-AllSpecies.txt')
dat00 <- read.csv('SpeDat00.csv')
dat01 <- gsub(' ','',dat00[,'种名'])
la00 <- sapply(dat01,
function(xx){grep(paste('^',xx,' ',sep=''), spedat)}
)
la01 <- as.numeric(la00)
dat00$species <- gsub('\\w+ +([A-Z][a-z]+ +[a-z]+) +.*',
"\\1", spedat[la01])
gen00 <- grep('属 +[A-Z]', spedat)
cu00 <- cut(la01, gen00)
gs00 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu00)
dat00$genus <- gsub('(\\w+) +[A-Z].*',
'\\1', spedat[as.numeric(g00)])
fam00 <- grep('科 +[A-Z]',spedat)
cu01 <- cut(la01, fam00)
gs01 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu01)
fam01 <- gsub('.* (\\w+ +[A-Z][a-z]+) ','\\1',
spedat[as.numeric(gs01)])
dat00$科名 <- gsub('(\\w+) +[A-Z].+','\\1', fam01)
dat00$family <- gsub('\\w+ +([A-Z].+)','\\1', fam01)
############
setwd('F:\\DataW\\shiwan-data')
spedat <- readLines('ShiWanDaShan-AllSpecies.txt')
dat00 <- read.csv('SpeDat00.csv')
dat00$种名 <- gsub(' ','',dat00$种名)
la00 <- sapply(dat00,
function(xx){grep(paste('^',xx,' ',sep=''), spedat)}
)
la00 <- as.numeric(la00)
dat00$species <- gsub('\\w+ +([A-Z][a-z]+ +[a-z]+) +.*',
"\\1", spedat[la00])
gen00 <- grep('属 +[A-Z]', spedat)
cu00 <- cut(la00, gen00)
gs00 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu00)
dat00$genus <- gsub('(\\w+) +[A-Z].*',
'\\1', spedat[as.numeric(gs00)])
fam00 <- grep('科 +[A-Z]',spedat)
cu01 <- cut(la00, fam00)
gs01 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu01)
fam01 <- gsub('.* (\\w+ +[A-Z][a-z]+) ','\\1',
spedat[as.numeric(gs01)])
dat00$科名 <- gsub('(\\w+) +[A-Z].+','\\1', fam01)
dat00$family <- gsub('\\w+ +([A-Z].+)','\\1', fam01)
##########
setwd('F:\\DataW\\shiwan-data')
spedat <- readLines('ShiWanDaShan-AllSpecies.txt')
dat00 <- read.csv('SpeDat00.csv')
dat00$种名 <- gsub(' ','',dat00$种名)
la00 <- sapply(dat00,
function(xx){grep(paste('^',xx,' ',sep=''), spedat)}
)
la00 <- as.numeric(la00)
dat00$species <- gsub('\\w+ +([A-Z][a-z]+ +[a-z]+) +.*',
"\\1", spedat[la00])
gen00 <- grep('属 +[A-Z]', spedat)
cu00 <- cut(la00, gen00)
gs00 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu00)
dat00$genus <- gsub('(\\w+) +[A-Z].*',
'\\1', spedat[as.numeric(gs00)])
fam00 <- grep('科 +[A-Z]',spedat)
cu01 <- cut(la00, fam00)
gs01 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu01)
fam01 <- gsub('.* (\\w+ +[A-Z][a-z]+) ','\\1',
spedat[as.numeric(gs01)])
dat00$科名 <- gsub('(\\w+) +[A-Z].+','\\1', fam01)
dat00$family <- gsub('\\w+ +([A-Z].+)','\\1', fam01)
############
setwd('F:\\DataW\\shiwan-data')
spedat <- readLines('ShiWanDaShan-AllSpecies.txt')
dat00 <- read.csv('SpeDat00.csv')
dat00$种名 <- gsub(' ','',dat00$种名)
la00 <- sapply(dat00$种名,
function(xx){grep(paste('^',xx,' ',sep=''), spedat)}
)
la00 <- as.numeric(la00)
dat00$species <- gsub('\\w+ +([A-Z][a-z]+ +[a-z]+) +.*',
"\\1", spedat[la00])
gen00 <- grep('属 +[A-Z]', spedat)
cu00 <- cut(la00, gen00)
gs00 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu00)
dat00$genus <- gsub('(\\w+) +[A-Z].*',
'\\1', spedat[as.numeric(gs00)])
fam00 <- grep('科 +[A-Z]',spedat)
cu01 <- cut(la00, fam00)
gs01 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu01)
fam01 <- gsub('.* (\\w+ +[A-Z][a-z]+) ','\\1',
spedat[as.numeric(gs01)])
dat00$科名 <- gsub('(\\w+) +[A-Z].+','\\1', fam01)
dat00$family <- gsub('\\w+ +([A-Z].+)','\\1', fam01)
##########################################################
setwd('F:\\DataW\\shiwan-data')
spedat <- readLines('ShiWanDaShan-AllSpecies.txt')
dat00 <- read.csv('SpeDat00.csv')
dat00$种名 <- gsub(' ','',dat00$种名)
la00 <- sapply(dat00$种名,
function(xx){grep(paste('^',xx,' ',sep=''), spedat)}
)
la00 <- as.numeric(la00)
dat00$species <- gsub('\\w+ +([A-Z][a-z]+ +[a-z]+) +.*',
"\\1", spedat[la00])
gen00 <- grep('属 +[A-Z]', spedat)
cu00 <- cut(la00, gen00)
gs00 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu00)
dat00$genus <- gsub('(\\w+) +[A-Z].*',
'\\1', spedat[as.numeric(gs00)])
fam00 <- grep('科 +[A-Z]',spedat)
cu01 <- cut(la00, fam00)
gs01 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu01)
fam01 <- gsub('.* (\\w+ +[A-Z][a-z]+) ','\\1',
spedat[as.numeric(gs01)])
dat00$科名 <- gsub('(\\w+) +[A-Z].+','\\1', fam01)
dat00$family <- gsub('\\w+ +([A-Z].+)','\\1', fam01)
##########################################################
as.numeric(la00)
la00
setwd('F:\\DataW\\shiwan-data')
spedat <- readLines('ShiWanDaShan-AllSpecies.txt')
dat00 <- read.csv('SpeDat00.csv')
dat00$种名 <- gsub(' ','',dat00$种名)
la00 <- sapply(dat00$种名,
function(xx){grep(paste('^',xx,' ',sep=''), spedat)}
)
la01 <- as.numeric(la00)
dat00$species <- gsub('\\w+ +([A-Z][a-z]+ +[a-z]+) +.*',
"\\1", spedat[la01])
gen00 <- grep('属 +[A-Z]', spedat)
cu00 <- cut(la01, gen00)
gs00 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu00)
dat00$genus <- gsub('(\\w+) +[A-Z].*',
'\\1', spedat[as.numeric(gs00)])
fam00 <- grep('科 +[A-Z]',spedat)
cu01 <- cut(la01, fam00)
gs01 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu01)
fam01 <- gsub('.* (\\w+ +[A-Z][a-z]+) ','\\1',
spedat[as.numeric(gs01)])
dat00$科名 <- gsub('(\\w+) +[A-Z].+','\\1', fam01)
dat00$family <- gsub('\\w+ +([A-Z].+)','\\1', fam01)
##########################################################
dat00
spedat[as.numeric(gs00)]
gsub('\\w+ +([A-Z][a-z]+) .*',
'\\1', spedat[as.numeric(gs00)])
########################################################
#
setwd('F:\\DataW\\shiwan-data')
spedat <- readLines('ShiWanDaShan-AllSpecies.txt')
dat00 <- read.csv('SpeDat00.csv')
dat00$种名 <- gsub(' ','',dat00$种名)
###
la00 <- sapply(dat00$种名,
function(xx){grep(paste('^',xx,' ',sep=''), spedat)}
)
la01 <- as.numeric(la00)
###
dat00$species <- gsub('\\w+ +([A-Z][a-z]+ +[a-z]+) +.*',
"\\1", spedat[la01])
###
gen00 <- grep('属 +[A-Z]', spedat)
cu00 <- cut(la01, gen00)
gs00 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu00)
dat00$属名 <- gsub('(\\w+) +[A-Z].*',
'\\1', spedat[as.numeric(gs00)])
dat00$genus <- gsub('\\w+ +([A-Z][a-z]+) .*',
'\\1', spedat[as.numeric(gs00)])
###
fam00 <- grep('科 +[A-Z]',spedat)
cu01 <- cut(la01, fam00)
gs01 <- gsub('\\(([0-9]+),[0-9]+]', '\\1', cu01)
fam01 <- gsub('.* (\\w+ +[A-Z][a-z]+) ','\\1',
spedat[as.numeric(gs01)])
dat00$科名 <- gsub('(\\w+) +[A-Z].+','\\1', fam01)
dat00$family <- gsub('\\w+ +([A-Z].+)','\\1', fam01)
##########################################################
dat00
write.csv(dat00, 'ShiWanSpeciesData00.csv')
